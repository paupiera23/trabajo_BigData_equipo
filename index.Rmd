---
title: "Sistema de Pensiones Espa√±ol"
author: "Pau Piera Palacios(paupiepa@alumni.uv.es)  \n\n Mario Garc√≠a Zamora(magarza2@alumni.uv.es)  \n \n Rub√©n Campos Campos (rucamcam@alumni.uv.es). \n\n Universitat de Val√®ncia"
date: "Diciembre de 2021 (actualizado el `r format(Sys.time(), '%d-%m-%Y')`)"
output:
  html_document:
    #css: "./assets/my_css_file.css"
    theme: paper
    highlight: textmate 
    toc: true
    toc_depth: 3 
    toc_float: 
      collapsed: true
      smooth_scroll: true
    self_contained: true
    number_sections: false
    df_print: kable
    code_download: true
editor_options: 
  chunk_output_type: console
---

```{r packages-setup, include = FALSE}

library(tidyverse)
library(klippy)  
library(knitr)
library(tibble)
library(ggthemes)
library(ggplot2)
library(dplyr)
library(patchwork)
library(ggrepel)
library(sf)
library(ggspatial)
library(rnaturalearth)
library(rnaturalearthdata)
library(pjpv2020.01)
library(plotly)
library(gganimate)
library (gifski)
library(gt)
library(kableExtra)
library(DT)
library(leaflet) 
library(leafem) 

```

```{r chunk-setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE, eval = TRUE, message = FALSE, warning = FALSE, 
                      #results = "hold",
                      cache = FALSE, cache.path = "/caches/", comment = "#>",
                      #fig.width = 7, #fig.height= 7,   
                      #out.width = 7, out.height = 7,
                      collapse = TRUE,  fig.show = "hold",
                      fig.asp = 7/9, out.width = "75%", fig.align = "center")
knitr::opts_chunk$set(dev = "png", dev.args = list(type = "cairo-png"))
```


```{r options-setup, include = FALSE}
options(scipen = 999) #- para quitar la notaci√≥n cient√≠fica
options("yaml.eval.expr" = TRUE) 
```


```{r klippy, echo = FALSE}
klippy::klippy(position = c("top", "right")) #- remotes::install_github("rlesur/klippy")
```



<hr class="linea-black">

<!-- El p√°rrafo de abajo has de dejarlo casi igual, solo HAS de SUSTITUIR "perezp44" por tu usuario de Github-->
Trabajo elaborado para la asignatura "Programaci√≥n y manejo de datos en la era del Big Data" de la Universitat de Val√®ncia durante el curso 2021-2022. El repo del trabajo est√° [aqu√≠](https://github.com/paupiera23/trabajo_BigData_equipo){target="_blank"}. 

<!-- El p√°rrafo de abajo has de dejarlo exactamente igual, NO has de cambiar nada-->

La p√°gina web de la asignatura y los trabajos de mis compa√±eros pueden verse [aqu√≠](https://perezp44.github.io/intro-ds-21-22-web/07-trabajos.html){target="_blank"}.

<hr class="linea-red">


#  <FONT COLOR="Black"> **Introducci√≥n** </FONT>

El principal an√°lisis de este trabajo va a ser el Sistema de pensiones espa√±ol y las diversas variables que lo envuelven al mismo. Dentro de estas variables podemos encontrar variables demogr√°ficas como pueden ser la esperanza de vida, la tasa de natalidad... tambi√©n vamos a analizar diversas variables econ√≥micas relacionadas tanto con el mercado laboral como en el gasto en pensiones...


Las pensiones en Espa√±a se han convertido en un tema abordable para su estudio y an√°lisis. Podemos decir que el sistema de pensiones se ve afectado por 2 grandes grupos de variables: la demograf√≠a y el mercado laboral. 

Para que lo entendamos, existen dos tipos de sistemas de pensiones:

Sistema de Reparto: los trabajadores del momento pagan unas cotizaciones a la seguridad social que est√°n destinadas al pago de las pensiones de dicho momento (Es decir, los trabajadores les pagan a los pensionistas y, cuando se jubilen, los antiguos trabajadores cobrar√°n gracias a los futuros trabajadores)

Sistema de Capitalizaci√≥n: cada trabajador hace sus aportaciones y, cuando se jubile, cobrar√° dichas aportaciones (actualizadas)

En Espa√±a el sistema que tenemos es el de reparto. Por tanto, este sistema funciona correctamente si la corriente de ingresos (trabajadores) y pagos (pensionistas) est√° equilibrada. En el momento en el que ese equilibrio se rompe de manera no transitoria, el problema se agrava y hay que abordarlo para que el sistema de pensiones sea sostenible. 

¬øQu√© est√° pasando con el sistema de pensiones espa√±ol? ¬øFunciona correctamente? ¬øEs sostenible?
Algunos expertos afirman que el sistema est√° quebrado:

Y otros, no piensan igual:

<iframe width="560" height="315" src="https://www.youtube.com/embed/6A5EpqqDOdk" frameborder="0" allowfullscreen></iframe>



<div/>



```{r, eval = TRUE, echo = FALSE}

library(vembedr)
embed_url("https://youtu.be/CPbdFImX5xo")


```



#   <FONT COLOR="black"> **Datos**</FONT> {.tabset}

## <FONT COLOR="black"> Extracci√≥n de datos </FONT>

Nos ha llevado un tiempo extraer todos los datos necesarios, la mayor√≠a son obtenidos del INE, aunque tambi√©n tenemos datos de Eurostat y del Banco de Espa√±a. Nos hemos descargado los datos en csv, algunos estaban bien, pero otros daban problemas debido a que no los reconoc√≠a como num√©ricos, los nombres de las variables eran demasiado largos, por lo que era inc√≥modo a la hora de trabajar y hab√≠a mucha informaci√≥n que sobraba. 

```{r, eval = TRUE, echo = FALSE}

knitr::include_graphics(here::here("imagenes", "inebase.jpg"))

knitr::include_graphics(here::here("imagenes", "banco_esp.jpg"))

knitr::include_graphics(here::here("imagenes", "eurostat.png"))

```


## <FONT COLOR="black">**C√≥digo**</FONT>

Una vez extraidos nuestros datos en formato .csv, nos ha tocado arreglarlos con Rstudio ya que muchas veces R no los detectava con formato numerico, no podiamos representar bien los gr√°ficos o simplemente queriamos explicar unos datos a partir de otros y nos ha tocado juntarlos en un mismo Dataframe

```{r, eval = TRUE}

#- Cargamos el df del paro que anteriormente hemos descargado del INE

df_paro <- rio::import("./datos/tasa_paro.csv")


df_paro <- df_paro %>%
  select(Paro, Periodos)

#Ahora cargamos los datos del df de la tasa de actividad nacional para poder compararlos con la tasa de paro nacional.

df_actividad <- rio::import("./datos/tasa_actividad.csv")

df_actividad <- df_actividad %>%
  select(Periodos, Tasa_Actividad)


#- Vamos a juntar el df de la tasa de actividad y la tasa de paro para poder hacer un gr√°fico donde se representen ambas tasas.

df_union <- inner_join(df_actividad, df_paro)

#Vamos a comparar la evoluci√≥n de la tasa de natalidad y del indice de envejecimiento para tener conocimiento de la evoluci√≥n que han tenido estas variables demogr√°ficas.

df_natalidad <- rio::import("./datos/tasa_natalidad.csv")

df_indice <- rio::import("./datos/indice_envejecimiento.csv")

df_indice <- df_indice %>%
  filter(Periodo != 2021) %>%
  rename(Periodos = "Periodo")

df_indice$Total <- as.numeric(df_indice$Total)

df_union_2 <- inner_join(df_natalidad, df_indice)

df_union_2 <- df_union_2 %>%
  select(Periodos, Tasa_Natalidad, Total)

#Cargamos el df de los ocupados por grupo de edad.

df_edad <- rio::import("./datos/ocup_edad.csv")

df_edad$Total <- as.numeric(df_edad$Total)

df_edad <- df_edad %>%
  mutate(fecha = lubridate::yq(Periodo)) %>%
  filter(fecha == "2021-07-01")


#Vamos a cargar los datos referentes a la edad de emancipacion de los jovenes en Espa√±a

df_eman <- rio::import("./datos/edad_emancipacion.csv")

df_eman <- df_eman %>%
 filter(!(Tramo_Edad %in% "16-34 edad"))

df_var <- df_eman %>%
  pivot_wider(names_from = Periodo, values_from = Porcentaje)

df_var <- janitor::clean_names(df_var)
names(df_var)

df_var <- df_var %>%
  mutate(variacion = (x2018 - x2008)/x2008)

#- Vamos a arreglar los datos de la pension media y del salario medio que encontramos en los siguientes df.

df_pens_med <- rio::import("./datos/pension_media.csv")

df_w_med <- rio::import("./datos/salario_medio.csv")

df_w_med$w_med_anual <- as.numeric(df_w_med$w_med_anual)

#- Vamos a unir los df de la pension media y del salario medio para observar la variacion entre ambas variables

df_union_3 <- inner_join(df_pens_med, df_w_med)

df_union_3 <- df_union_3 %>%
  select(periodo, pension_media_anual, w_med_anual) %>%
  mutate(porcentaje = (pension_media_anual/w_med_anual)*100)

#Vamos a arreglar los datos referentes a la evoluci√≥n de la esperanza de vida en Espa√±a

df_vida <- rio::import("./datos/esperanza_vida.csv")

df_vida <- df_vida %>%
  select("geo", "TIME_PERIOD", "OBS_VALUE") %>%
  rename(pais = "geo", periodo = "TIME_PERIOD", esperanza_vida = "OBS_VALUE")

#nos quedamos con los datos que queremos mostrar

df_vida <- df_vida %>%
  filter(pais  %in% c("FR", "ES", "IT", "PT", "AL") )

#Arreglamos los datos del Fondo de Reserva de las pensiones

df_fondo <- rio::import("./datos/fondo_reserva.csv")

df_fondo$millones_euros <- as.numeric(df_fondo$millones_euros)

#Cargamos y arreglamos los df de la piramide poblacional y de la proyeccion

df_piramide <- rio::import("./datos/piramide_pob.csv")

df_piramide$Total <- as.numeric(df_piramide$Total)

df_piramide_20 <- df_piramide %>%
  filter(`A√±o` == 2020) %>%
  arrange(`A√±o`)

df_proyeccion <- rio::import("./datos/proyeccion_2070.csv")

df_proyeccion$total_red <- as.numeric(df_proyeccion$total_red)

#Creamos los df para los a√±os que queremos mostrar.

df_proyeccion_36 <- df_proyeccion %>%
  filter(Periodo == 2036)

df_proyeccion_50 <- df_proyeccion %>%
  filter(Periodo == 2050)

df_proyeccion_70 <- df_proyeccion %>%
  filter(Periodo == 2070)


```

# <FONT COLOR="Black">  **Variables Demogr√°ficas**  </FONT>



## <FONT COLOR="Black">  Natalidad Vs. Envejecimiento </FONT> {.tabset}


### <FONT COLOR="Black"> **An√°lisis**  </FONT>

```{r, eval = TRUE, echo = FALSE}

p2 <- ggplot(df_union_2) +
  geom_line(aes(Periodos, Tasa_Natalidad)) + 
  geom_point(aes(Periodos, Tasa_Natalidad)) +
  geom_line(aes(Periodos, Total))+
  geom_point(aes(Periodos, Total))+
  scale_y_continuous(name = "Indice de envejecimiento", 
                     sec.axis = sec_axis(~./5, name = "Tasa Natalidad", 
                                         labels = function(b) { paste0(round(b * 4, 0), "%")})) +
  labs(title = "Comparaci√≥n Tasa de Natalidad e √çndice de Envejecimiento",
    subtitle = "Datos extraidos del INEBase")


ggplotly(p2)

```

<br>
<br>
<br>

### <FONT COLOR="Black"> **C√≥digo**  </FONT>


```{r, eval = FALSE, echo = TRUE}

p2 <- ggplot(df_union_2) +
  geom_line(aes(Periodos, Tasa_Natalidad)) + 
  geom_point(aes(Periodos, Tasa_Natalidad)) +
  geom_line(aes(Periodos, Total))+
  geom_point(aes(Periodos, Total))+
  scale_y_continuous(name = "Indice de envejecimiento", 
                     sec.axis = sec_axis(~./5, name = "Tasa Natalidad", 
                                         labels = function(b) { paste0(round(b * 4, 0), "%")})) +
  labs(title = "Comparaci√≥n Tasa de Natalidad e √çndice de Envejecimiento",
    subtitle = "Datos extraidos del INEBase")


ggplotly(p2)

```


<br>
<br>
<br>

## <FONT COLOR="Black">  Evoluci√≥n de la esperanza de vida  </FONT> {.tabset}


### <FONT COLOR="Black"> **An√°lisis**  </FONT>

asdasdasd

```{r, eval = TRUE, echo = FALSE}

p11 <- ggplot(df_vida) +
 aes(x = periodo, y = esperanza_vida, colour = pais) +
 geom_line(size = 1) +
 theme_minimal() + 
  theme(plot.subtitle = element_text(size = 11)) +labs(title = "Evoluci√≥n de la esperanza de vida por paises",
    x = "Periodo", y = "A√±os de vida", subtitle = "Datos extraidos de Eurostat")

ggplotly(p11)

```

<br>
<br>
<br>


### <FONT COLOR="Black"> **C√≥digo**  </FONT>


```{r, eval = FALSE, echo = TRUE}

p11 <- ggplot(df_vida) +
 aes(x = periodo, y = esperanza_vida, colour = pais) +
 geom_line(size = 1) +
 theme_minimal() + 
  theme(plot.subtitle = element_text(size = 11)) +labs(title = "Evoluci√≥n de la esperanza de vida por paises",
    x = "Periodo", y = "A√±os de vida", subtitle = "Datos extraidos de Eurostat")

ggplotly(p11)

```

## <FONT COLOR="Black">  Piramide Poblacional  </FONT> {.tabset}

### <FONT COLOR="Black"> **An√°lisis**  </FONT>

```{r, eval = TRUE, echo = FALSE}

p13 <- ggplot(df_piramide, aes(x = `Edad (grupos quinquenales)`,
                y = `Total`,
                fill = Sexo)) +
  geom_col(data = subset(df_piramide, Sexo == "Hombres") %>% 
             mutate(`Total` = - `Total`),
           width = 0.5, fill = "blue") +
  geom_col(data = subset(df_piramide, Sexo == "Mujeres"),
           width = 0.5, fill = "pink") + 
  coord_flip()+labs(title = "Piramide Poblacional a√±o 2020 ",
    y = "Miles de Personas", subtitle = "Datos extraidos del INEBase")

ggplotly(p13)

```


### <FONT COLOR="Black"> **C√≥digo**  </FONT>

```{r, eval = FALSE, echo = TRUE}

p13 <- ggplot(df_piramide, aes(x = `Edad (grupos quinquenales)`,
                y = `Total`,
                fill = Sexo)) +
  geom_col(data = subset(df_piramide, Sexo == "Hombres") %>% 
             mutate(`Total` = - `Total`),
           width = 0.5, fill = "blue") +
  geom_col(data = subset(df_piramide, Sexo == "Mujeres"),
           width = 0.5, fill = "pink") + 
  coord_flip()+labs(title = "Piramide Poblacional a√±o 2020 ",
    y = "Miles de Personas", subtitle = "Datos extraidos del INEBase")

ggplotly(p13)

```


## <FONT COLOR="Black">  Proyecciones Poblacionales  </FONT> {.tabset}



### <FONT COLOR="Black"> **2036**  </FONT>

```{r, eval = TRUE, echo = FALSE}

p14 <- ggplot(df_proyeccion_36, aes(x = `Edad`,
                        y = `total_red`,
                        fill = Sexo)) +
  geom_col(data = subset(df_proyeccion_36, Sexo == "Hombres") %>% 
             mutate(`total_red` = - `total_red`),
           width = 0.5, fill = "blue") +
  geom_col(data = subset(df_proyeccion_36, Sexo == "Mujeres"),
           width = 0.5, fill = "pink") + 
  coord_flip()+labs(title = "Piramide Poblacional a√±o 2036",
    y = "Miles de personas", subtitle = "Datos extraidos del INEBase")

ggplotly(p14)

```

### <FONT COLOR="Black"> **2050**  </FONT>

```{r, eval = TRUE, echo = FALSE}

p15 <- ggplot(df_proyeccion_50, aes(x = `Edad`,
                             y = `total_red`,
                             fill = Sexo)) +
  geom_col(data = subset(df_proyeccion_50, Sexo == "Hombres") %>% 
             mutate(`total_red` = - `total_red`),
           width = 0.5, fill = "blue") +
  geom_col(data = subset(df_proyeccion_50, Sexo == "Mujeres"),
           width = 0.5, fill = "pink") + 
  coord_flip() +
  labs(title = "Piramide Poblacional a√±o 2050",
       y = "Miles de personas", subtitle = "Datos extraidos del INEBase")

ggplotly(p15)

```

### <FONT COLOR="Black"> **2070**  </FONT>

```{r, eval = TRUE, echo = FALSE}

p16 <- ggplot(df_proyeccion_70, aes(x = `Edad`,
                             y = `total_red`,
                             fill = Sexo)) +
  geom_col(data = subset(df_proyeccion_70, Sexo == "Hombres") %>% 
             mutate(`total_red` = - `total_red`),
           width = 0.5, fill = "blue") +
  geom_col(data = subset(df_proyeccion_70, Sexo == "Mujeres"),
           width = 0.5, fill = "pink") + 
  coord_flip() +
  labs(title = "Piramide Poblacional a√±o 2070",
       y = "Miles de personas", subtitle = "Datos extraidos del INEBase")

ggplotly(p16)

```

## <FONT COLOR="Black">  Emancipaci√≥n  </FONT> {.tabset}



### <FONT COLOR="Black"> **An√°lisis**  </FONT>




```{r, eval = TRUE, echo = FALSE}

p8 <- ggplot(df_eman) +
 aes(x = Tramo_Edad, fill = Tramo_Edad, weight = Porcentaje) +
 geom_bar() +
 scale_fill_viridis_d(option = "viridis", 
 direction = 1) +
 theme_minimal() +
 facet_wrap(vars(Periodo)) + theme(plot.subtitle = element_text(size = 11),
    axis.title = element_text(size = 13),
    plot.title = element_text(size = 16)) +labs(title = "Porcentaje de Emancipados por edad",
    x = "Tramo de Edad", y = "Porcentaje de emancipados",
    subtitle = "Datos extraidos del BBVA Research Foundation")

ggplotly(p8)

```

<br>

```{r, eval = TRUE, echo = FALSE}
 p9 <- ggplot(df_var) +
 aes(x = tramo_edad, fill = tramo_edad, weight = variacion) +
 geom_bar() +
 scale_fill_viridis_d(option = "viridis", 
 direction = 1) +
 theme_minimal() + theme(plot.subtitle = element_text(size = 10)) +labs(title = "Variaci√≥n porcentual de emancipados 2018 - 2008",
    x = "Tramo de Edad", y = "Variaci√≥n de emancipados",
    fill = "Tramo de Edad", subtitle = "Datos extraidos del BBVA Research")

ggplotly(p9)


```


<br>
<br>
<br>

### <FONT COLOR="Black"> **C√≥digo**  </FONT>

```{r, eval = FALSE, echo = TRUE}

p8 <- ggplot(df_eman) +
 aes(x = Tramo_Edad, fill = Tramo_Edad, weight = Porcentaje) +
 geom_bar() +
 scale_fill_viridis_d(option = "viridis", 
 direction = 1) +
 theme_minimal() +
 facet_wrap(vars(Periodo)) + theme(plot.subtitle = element_text(size = 11),
    axis.title = element_text(size = 13),
    plot.title = element_text(size = 16)) +labs(title = "Porcentaje de Emancipados por edad",
    x = "Tramo de Edad", y = "Porcentaje de emancipados",
    subtitle = "Datos extraidos del BBVA Research Foundation")

ggplotly(p8)


 p9 <- ggplot(df_var) +
 aes(x = tramo_edad, fill = tramo_edad, weight = variacion) +
 geom_bar() +
 scale_fill_viridis_d(option = "viridis", 
 direction = 1) +
 theme_minimal() + theme(plot.subtitle = element_text(size = 10)) +labs(title = "Variaci√≥n porcentual de emancipados 2018 - 2008",
    x = "Tramo de Edad", y = "Variaci√≥n de emancipados",
    fill = "Tramo de Edad", subtitle = "Datos extraidos del BBVA Research")

ggplotly(p9)

```


<br>
<br>
<br>

# <FONT COLOR="Black">  **Mercado Laboral**  </FONT>

## <FONT COLOR="Black">  Tasa de Paro Vs. Actividad  </FONT> {.tabset}


### <FONT COLOR="Black"> **An√°lisis**  </FONT>

fsdfasd

```{r, eval = TRUE, echo = FALSE}

p4 <- ggplot(df_union) +
  geom_bar(aes(Periodos, Tasa_Actividad), stat = "identity", fill = "grey") +
  geom_line(aes(Periodos, Paro), size = 1) +
  geom_point(aes(Periodos, Paro), size = 2) +
  labs(title = "Comparaci√≥n Tasa de Paro y de Actividad",
       subtitle = "Datos para el periodo 2002 - 2020",
       caption = "Datos provenientes del INEBase",
       y = "Tasa de Paro y Actividad") 


ggplotly(p4)

```

<br>
<br>
<br>

### <FONT COLOR="Black">  **C√≥digo**  </FONT>

```{r, eval = FALSE, echo = TRUE}
p4 <- ggplot(df_union) +
  geom_bar(aes(Periodos, Tasa_Actividad), stat = "identity", fill = "grey") +
  geom_line(aes(Periodos, Paro), size = 1) +
  geom_point(aes(Periodos, Paro), size = 2) +
  labs(title = "Comparaci√≥n Tasa de Paro y de Actividad",
       subtitle = "Datos para el periodo 2002 - 2020",
       caption = "Datos provenientes del INEBase",
       y = "Tasa de Paro y Actividad") 


ggplotly(p4)


```

<br>
<br>
<br>



## <FONT COLOR="Black">  Ocupados por grupo de Edad  </FONT> {.tabset}


### <FONT COLOR="Black"> **An√°lisis**  </FONT>

```{r, eval = TRUE, echo = FALSE}

p10 <- ggplot(df_edad) +
 aes(x = Edad, fill = Edad, weight = Total) +
 geom_bar() +
 scale_fill_viridis_d(option = "viridis", 
 direction = 1) +
 theme_minimal()+labs(title = "Ocupados por grupo de Edad en 2021",
    x = NULL, y = "Miles de Personas", subtitle = "Datos extraidos del INEBase")

ggplotly(p10)

```

<br>
<br>
<br>


### <FONT COLOR="Black">  **C√≥digo**  </FONT>

```{r, eval = FALSE, echo = TRUE}

p10 <- ggplot(df_edad) +
 aes(x = Edad, fill = Edad, weight = Total) +
 geom_bar() +
 scale_fill_viridis_d(option = "viridis", 
 direction = 1) +
 theme_minimal()+labs(title = "Ocupados por grupo de Edad en 2021",
    x = NULL, y = "Miles de Personas", subtitle = "Datos extraidos del INEBase")

ggplotly(p10)

```

<br>
<br>
<br>


# <FONT COLOR="Black">  **Pensiones**  </FONT> 


## <FONT COLOR="Black"> Evoluci√≥n del Fondo de Reserva </FONT>{.tabset}

### <FONT COLOR="Black"> **An√°lisis**  </FONT>

```{r, eval = TRUE, echo = FALSE}


p12 <- ggplot(df_fondo) +
 aes(x = periodo, y = millones_euros) +
 geom_line(size = 1, colour = "#066DD1") +
  geom_point()+labs(title = "Evoluci√≥n del Fondo de Reserva 2000 - 2019",
    x = "Periodo", y = "Millones de Euros",
    subtitle = "Datos extraidos del INEBase")

ggplotly(p12)


```

<br>
<br>
<br>


### <FONT COLOR="Black">  **C√≥digo**  </FONT>

```{r, eval = FALSE, echo = TRUE}

p12 <- ggplot(df_fondo) +
 aes(x = periodo, y = millones_euros) +
 geom_line(size = 1, colour = "#066DD1") +
  geom_point()+labs(title = "Evoluci√≥n del Fondo de Reserva 2000 - 2019",
    x = "Periodo", y = "Millones de Euros",
    subtitle = "Datos extraidos del INEBase")

ggplotly(p12)


```

<br>
<br>
<br>

## <FONT COLOR="Black">  Tasa de cobertura o reemplazo  </FONT> {.tabset}


### <FONT COLOR="Black"> **An√°lisis**  </FONT>

```{r, eval = TRUE, echo = FALSE}

p7 <- ggplot(df_union_3, aes(periodo, porcentaje)) + 
  geom_line(size = 0.8) + 
  geom_point() + 
  theme(axis.line = element_line(size = 0.5),
    panel.grid.major = element_line(size = 0),
    axis.text = element_text(size = 12),
    panel.background = element_rect(fill = "gray85"),
    plot.background = element_rect(fill = "white")) +labs(title = "Tasa de cobertura o reemplazo de la pensi√≥n media",
    x = "Periodo", y = "Porcentaje", subtitle = "Datos extraidos del INEBase ") 

ggplotly(p7)

```

<br>
<br>
<br>


### <FONT COLOR="Black">  **C√≥digo**  </FONT>

```{r, eval = FALSE, echo = TRUE}

p7 <- ggplot(df_union_3, aes(periodo, porcentaje)) + 
  geom_line(size = 0.8) + 
  geom_point() + 
  theme(axis.line = element_line(size = 0.5),
    panel.grid.major = element_line(size = 0),
    axis.text = element_text(size = 12),
    panel.background = element_rect(fill = "gray85"),
    plot.background = element_rect(fill = "white")) +labs(title = "Tasa de cobertura o reemplazo de la pensi√≥n media",
    x = "Periodo", y = "Porcentaje", subtitle = "Datos extraidos del INEBase ")

ggplotly(p7)

```
 
<br>
<br>
<br>

<div class = "caja-medium-aquamarine">
Recuerda que el capitan del equipo **tiene que mandarme un mail** con su nombre, usuario de Github, nombre del trabajo en equipo y el nombre de sus compa√±eros de equipo.
</div>

<br>

<div class = "caja-crimson">
Recuerda que el repo de Github **se ha de llamar EXACTAMENTE** "trabajo_BigData_equipo"  
</div>

<br>

<div class = "caja-darkkhaki">
Por favor, **no cambies el primer p√°rrafo**. Sirve para dar contexto al trabajo y remitir a los potenciales lectores a la web del curso y poder ver los otros trabajos. Bueno, si que has de cambiar algo: **has de sutituir "perezp44" por tu usuario de Github**, tanto en el archivo index.Rmd como en el Readme.Rmd
</div>


<br>

<div class = "caja-linea-verde">
Recuerda , la fecha l√≠mite para la entrega es el 15 de diciembre, 2 d√≠as antes de la exposici√≥n de los trabsjos
</div>


<br>

<hr class="linea-red">


<div class = "caja-gris-gainboro">
SUERTE!!!!  üßô‚Äç‚ôÄÔ∏èüßô‚Äç‚ôÄÔ∏è
</div>




# 4. Bibliograf√≠a

No tienen porque ser art√≠culos o libros; pueden ser posts, repos de Github, paquetes etc ...

<br><br>

<hr class="linea-red">
<hr class="linea-red">


```{r, echo = FALSE}
sessioninfo::session_info() %>% details::details(summary = 'Informaci√≥n de mi R-sesi√≥n:') 
```


<br><br>

<div class="tocify-extend-page" data-unique="tocify-extend-page" style="height: 0;"></div>
